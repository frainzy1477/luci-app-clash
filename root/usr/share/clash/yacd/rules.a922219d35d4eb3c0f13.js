(self.webpackChunkyacd=self.webpackChunkyacd||[]).push([[981],{97193:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return fe}});t(82526),t(57327),t(54747),t(49337);var n=t(90924),i=t(94949),s=t(67294),a=t(64478),o=t(69834),u=t(70207),c=t(25904),l=(t(82772),t(88767)),f=t(2804),p=t(80043),d=t(87757),v=t.n(d),h=(t(88674),t(41539),t(97943));function g(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function y(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?g(Object(t),!0).forEach((function(r){(0,i.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):g(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function m(e){for(var r=e.providers,t=Object.keys(r),n={},i=0;i<t.length;i++){var s=t[i];n[s]=y(y({},r[s]),{},{idx:i})}return{byName:n,names:t}}function b(){return(b=(0,p.Z)(v().mark((function e(r,t){var n,i,s,a,o;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,h.g)(t),i=n.url,s=n.init,a={providers:{}},e.prev=2,e.next=5,fetch(i+r,s);case 5:if(!(o=e.sent).ok){e.next=10;break}return e.next=9,o.json();case 9:a=e.sent;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),console.log("failed to GET /providers/rules",e.t0);case 15:return e.abrupt("return",m(a));case 16:case"end":return e.stop()}}),e,null,[[2,12]])})))).apply(this,arguments)}function j(e){return x.apply(this,arguments)}function x(){return(x=(0,p.Z)(v().mark((function e(r){var t,n,i,s,a,o;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.name,n=r.apiConfig,i=(0,h.g)(n),s=i.url,a=i.init,e.prev=2,e.next=5,fetch(s+`/providers/rules/${t}`,y({method:"PUT"},a));case 5:return o=e.sent,e.abrupt("return",o.ok);case 9:return e.prev=9,e.t0=e.catch(2),console.log("failed to PUT /providers/rules/:name",e.t0),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}function O(e){return w.apply(this,arguments)}function w(){return(w=(0,p.Z)(v().mark((function e(r){var t,n,i;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=r.names,n=r.apiConfig,i=0;case 2:if(!(i<t.length)){e.next=8;break}return e.next=5,j({name:t[i],apiConfig:n});case 5:i++,e.next=2;break;case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t(21249);var C=t(41143),k=t.n(C);function P(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function Z(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?P(Object(t),!0).forEach((function(r){(0,i.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):P(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function E(e){return k()(e.rules&&e.rules.length>=0,"there is no valid rules list in the rules API response"),e.rules.map((function(e,r){return Z(Z({},e),{},{id:r})}))}function _(){return(_=(0,p.Z)(v().mark((function e(r,t){var n,i,s,a,o;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={rules:[]},e.prev=1,i=(0,h.g)(t),s=i.url,a=i.init,e.next=5,fetch(s+r,a);case 5:if(!(o=e.sent).ok){e.next=10;break}return e.next=9,o.json();case 9:n=e.sent;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.log("failed to fetch rules",e.t0);case 15:return e.abrupt("return",E(n));case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}var N=(0,f.cn)({key:"ruleFilterText",default:""});s.useCallback;function D(e){return(0,l.useQuery)(["/providers/rules",e],(function(){return function(e,r){return b.apply(this,arguments)}("/providers/rules",e)}))}function L(e){var r=(0,l.useQuery)(["/rules",e],(function(){return function(e,r){return _.apply(this,arguments)}("/rules",e)})),t=r.data,i=r.isFetching,s=D(e).data,a=(0,f.FV)(N),o=(0,n.Z)(a,1)[0];if(""===o)return{rules:t,provider:s,isFetching:i};var u=o.toLowerCase();return{rules:t.filter((function(e){return e.payload.toLowerCase().indexOf(u)>=0})),isFetching:i,provider:{byName:s.byName,names:s.names.filter((function(e){return e.toLowerCase().indexOf(u)>=0}))}}}var S=t(17132),F=t(14236),R="_2F14Vs-eyF",$="x4HgsJSs_L",T="_1AQt0kcvQz",Q="_28wqsVo1h2",V="_1g-irMIYO_",z=t(85893);function A(e){var r=e.idx,t=e.name,i=e.vehicleType,s=e.behavior,a=e.updatedAt,o=e.ruleCount,f=function(e,r){var t=(0,l.useQueryClient)(),n=(0,l.useMutation)(j,{onSuccess:function(){t.invalidateQueries("/providers/rules")}}),i=n.mutate;return[function(t){t.preventDefault(),i({name:e,apiConfig:r})},n.isLoading]}(t,e.apiConfig),p=(0,n.Z)(f,2),d=p[0],v=p[1],h=(0,u.Z)(new Date(a),new Date);return(0,z.jsxs)("div",{className:R,children:[(0,z.jsx)("span",{className:$,children:r}),(0,z.jsxs)("div",{className:T,children:[(0,z.jsx)(S.$,{name:t,type:`${i} / ${s}`}),(0,z.jsx)("div",{className:Q,children:o<2?`${o} rule`:`${o} rules`}),(0,z.jsxs)("small",{className:Q,children:["Updated ",h," ago"]})]}),(0,z.jsx)("span",{className:V,children:(0,z.jsx)(c.Z,{onClick:d,disabled:v,children:(0,z.jsx)(F.V,{isRotating:v})})})]})}var I=t(51525);function W(e){var r=function(e){var r=(0,l.useQueryClient)(),t=D(e).data,n=(0,l.useMutation)(O,{onSuccess:function(){r.invalidateQueries("/providers/rules")}}),i=n.mutate;return[function(r){r.preventDefault(),i({names:t.names,apiConfig:e})},n.isLoading]}(e.apiConfig),t=(0,n.Z)(r,2),i=t[0],s=t[1],o=(0,a.$)().t;return(0,z.jsx)(I.Lg,{icon:(0,z.jsx)(F.V,{isRotating:s}),text:o("update_all_rule_provider"),style:I.FK,onClick:i})}var q=t(44774),M=t(57944);function U(){var e=(0,q.g)(N),r=(0,n.Z)(e,2),t=r[0],i=r[1];return(0,z.jsx)("input",{className:M.Z.input,type:"text",value:i,onChange:t,placeholder:"Filter"})}var B=t(87462),K=t(6055),Y=t(82569),J="_2ZxnpAgEbI",G="_1Waxn5PO-y",H="_1YW1imuuRW",X="_3Anv9Ytzq4",ee="_28txnmlSD3",re={_default:"#59caf9",DIRECT:"#f5bc41",REJECT:"#cb3166"};var te=function(e){var r=e.type,t=e.payload,n=e.proxy,i=e.id,s=function(e){var r=e.proxy,t=re._default;return re[r]&&(t=re[r]),{color:t}}({proxy:n});return(0,z.jsxs)("div",{className:J,children:[(0,z.jsx)("div",{className:G,children:i}),(0,z.jsxs)("div",{children:[(0,z.jsx)("div",{className:X,children:t}),(0,z.jsxs)("div",{className:H,children:[(0,z.jsx)("div",{className:ee,children:r}),(0,z.jsx)("div",{style:s,children:n})]})]})]})},ne="_3WrcX9K2WQ",ie="_109LiAqCt-",se=t(85295);function ae(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function oe(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ae(Object(t),!0).forEach((function(r){(0,i.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ae(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var ue=s.memo;function ce(e,r){var t=r.rules,n=r.provider,i=n.names.length;return e<i?n.names[e]:t[e-i].id}var le=ue((function(e){var r=e.index,t=e.style,n=e.data,i=n.rules,s=n.provider,a=n.apiConfig,o=s.names.length;if(r<o){var u=s.names[r],c=s.byName[u];return(0,z.jsx)("div",{style:t,className:ie,children:(0,z.jsx)(A,oe({apiConfig:a},c))})}var l=i[r-o];return(0,z.jsx)("div",{style:t,children:(0,z.jsx)(te,oe({},l))})}),o.wy),fe=(0,se.$j)((function(e){return{apiConfig:(0,K.Y$)(e)}}))((function(e){var r=e.apiConfig,t=(0,B.Z)(),i=(0,n.Z)(t,2),s=i[0],u=i[1],c=L(r),l=c.rules,f=c.provider,p=function(e){var r=e.provider;return function(e){return e<r.names.length?90:80}}({provider:f}),d=(0,a.$)().t;return(0,z.jsxs)("div",{children:[(0,z.jsxs)("div",{className:ne,children:[(0,z.jsx)(Y.Z,{title:d("Rules")}),(0,z.jsx)(U,{})]}),(0,z.jsx)("div",{ref:s,style:{paddingBottom:30},children:(0,z.jsx)(o.S_,{height:u-30,width:"100%",itemCount:l.length+f.names.length,itemSize:p,itemData:{rules:l,provider:f,apiConfig:r},itemKey:ce,children:le})}),f&&f.names&&f.names.length>0?(0,z.jsx)(W,{apiConfig:r}):null]})}))},51525:function(e,r,t){"use strict";t.d(r,{aU:function(){return n.Action},Lg:function(){return n.Fab},$4:function(){return a},FK:function(){return o}});t(67294);var n=t(66018),i="_3nmqcBZJL5",s=t(85893);function a(e){var r=e.children;return(0,s.jsx)("span",{className:i,children:r})}var o={right:10,bottom:10}},14236:function(e,r,t){"use strict";t.d(r,{V:function(){return u}});var n=t(86010),i=(t(67294),t(86178)),s="_3UD6wCqqgE",a="W4xtnaGef4",o=t(85893);function u(e){var r=e.isRotating,t=(0,n.Z)(s,{[a]:r});return(0,o.jsx)("span",{className:t,children:(0,o.jsx)(i.Z,{width:16})})}},87462:function(e,r,t){"use strict";t.d(r,{Z:function(){return c}});var n=t(90924),i=t(67294),s=i.useState,a=i.useRef,o=i.useCallback,u=i.useLayoutEffect;function c(){var e=a(null),r=s(200),t=(0,n.Z)(r,2),i=t[0],c=t[1],l=o((function(){var r=e.current.getBoundingClientRect().top;c(window.innerHeight-r)}),[]);return u((function(){return l(),window.addEventListener("resize",l),function(){window.removeEventListener("resize",l)}}),[l]),[e,i]}},44774:function(e,r,t){"use strict";t.d(r,{g:function(){return l}});var n=t(90924),i=t(79481),s=t(67294),a=t(2804),o=s.useCallback,u=s.useState,c=s.useMemo;function l(e){var r=(0,a.FV)(e),t=(0,n.Z)(r,2)[1],s=u(""),l=(0,n.Z)(s,2),f=l[0],p=l[1],d=c((function(){return(0,i.Z)(t,300)}),[t]);return[o((function(e){p(e.target.value),d(e.target.value)}),[d]),f]}},41143:function(e){"use strict";e.exports=function(e,r,t,n,i,s,a,o){if(!e){var u;if(void 0===r)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[t,n,i,s,a,o],l=0;(u=new Error(r.replace(/%s/g,(function(){return c[l++]})))).name="Invariant Violation"}throw u.framesToPop=1,u}}},57944:function(e,r){"use strict";r.Z={input:"_1I0EXOg8Vu"}},86178:function(e,r,t){"use strict";var n=t(67294),i=t(45697),s=t.n(i);function a(){return(a=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function o(e,r){if(null==e)return{};var t,n,i=function(e,r){if(null==e)return{};var t,n,i={},s=Object.keys(e);for(n=0;n<s.length;n++)t=s[n],r.indexOf(t)>=0||(i[t]=e[t]);return i}(e,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)t=s[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var u=(0,n.forwardRef)((function(e,r){var t=e.color,i=void 0===t?"currentColor":t,s=e.size,u=void 0===s?24:s,c=o(e,["color","size"]);return n.createElement("svg",a({ref:r,xmlns:"http://www.w3.org/2000/svg",width:u,height:u,viewBox:"0 0 24 24",fill:"none",stroke:i,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},c),n.createElement("polyline",{points:"23 4 23 10 17 10"}),n.createElement("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"}))}));u.propTypes={color:s().string,size:s().oneOfType([s().string,s().number])},u.displayName="RotateCw",r.Z=u}}]);
//# sourceMappingURL=rules.a922219d35d4eb3c0f13.js.map